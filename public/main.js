"use strict";window.app=angular.module("CareFarApp",["fsaPreBuilt","ui.router","ui.bootstrap","ngAnimate"]),app.config(["$urlRouterProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.otherwise("/"),t.when("/auth/:provider",function(){window.location.reload()})}]),app.run(["$rootScope","$window",function(t,e){e.ga("create","UA-85556846-1","auto"),t.$on("$stateChangeError",function(t,e,o,n,i,a){console.info('The following error was thrown by ui-router while transitioning to state "${toState.name}". The origin of this error is probably a resolve function:'),console.error(a)}),t.$on("$stateChangeSuccess",function(t){e.ga("send","pageview",$location.path())})}]),app.run(["$rootScope","AuthService","$state",function(t,e,o){var n=function(t){return t.data&&t.data.authenticate};t.$on("$stateChangeStart",function(t,i,a){$window.ga("send","pageviewClick",$location.path()),n(i)&&(e.isAuthenticated()||(t.preventDefault(),e.getLoggedInUser().then(function(t){t?o.go(i.name,a):o.go("login")})))})}]),app.config(["$stateProvider",function(t){t.state("about",{url:"/about",controller:"AboutController",templateUrl:"js/about/about.html"})}]),app.controller("AboutController",["$scope","FullstackPics",function(t,e){t.images=_.shuffle(e)}]),app.config(["$stateProvider",function(t){t.state("docs",{url:"/docs",templateUrl:"js/docs/docs.html"})}]),app.controller("modalCtrl",["content","$scope",function(t,e){e.content=t}]),app.controller("gridCtrl",["$scope","$uibModal",function(t,e){var o=function(t){return allContent[t]};t.openModal=function(t){e.open({templateUrl:"js/grid/modalContent.html",resolve:{content:function(){return o(t)}},controller:"modalCtrl"})}}]);var allContent={fallDetection:{title:"Automatic Fall Detection",body:"Smart phones have sophisticated sensors and systems built in that can be used to detect very granular movements.  Our app uses these sensors to detect if someone may have fallen and can run in the background."},notifyFamily:{title:"Notify Family",body:"Up to 5 family members or caregivers can be signed-up to receive email notifications in the free app.  To enable SMS notification and automated phone-calls, please sign up for the PRO version of the app.  More family members can also be added in the PRO version."},emergencyButton:{title:"Emergency Button",body:"If the elder is in an uncomfortable, or worse, an unsafe situation, they can quickly alert their family without having to dial individual phone numbers.  Whether it’s because of suspicious people around the home, or because the elder fell and is struggling to get up, the elder can let a group of people know right away."},easeOfUse:{title:"Ease of Setup and Use",body:"The phone battery is minimally impacted due to the app. If the user also uses the phone for multiple uses, such as communications and entertainment, we advise the phone be left to charge when not used for fall detection."},coverage:{title:"24 x 7 Coverage",body:"Up to 5 family members or caregivers can be signed-up to receive email notifications in the free app.  To enable SMS notification and automated phone-calls, please sign up for the PRO version of the app.  More family members can also be added in the PRO version."},free:{title:"Free!",body:"Up to 5 family members or caregivers can be signed-up to receive email notifications in the free app.  To enable SMS notification and automated phone-calls, please sign up for the PRO version of the app.  More family members can also be added in the PRO version."}}(function(){if(!window.angular)throw new Error("I can't find Angular!");var t=angular.module("fsaPreBuilt",[]);t.factory("Socket",function(){if(!window.io)throw new Error("socket.io not found!");return window.io(window.location.origin)}),t.constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),t.factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS",function(t,e,o){var n={401:o.notAuthenticated,403:o.notAuthorized,419:o.sessionTimeout,440:o.sessionTimeout};return{responseError:function(o){return t.$broadcast(n[o.status],o),e.reject(o)}}}]),t.config(["$httpProvider",function(t){t.interceptors.push(["$injector",function(t){return t.get("AuthInterceptor")}])}]),t.service("AuthService",["$http","Session","$rootScope","AUTH_EVENTS","$q",function(t,e,o,n,i){function a(t){var i=t.data.user;return e.create(i),o.$broadcast(n.loginSuccess),i}this.isAuthenticated=function(){return!!e.user},this.getLoggedInUser=function(o){return this.isAuthenticated()&&o!==!0?i.when(e.user):t.get("/session").then(a)["catch"](function(){return null})},this.login=function(e){return t.post("/login",e).then(a)["catch"](function(){return i.reject({message:"Invalid login credentials."})})},this.logout=function(){return t.get("/logout").then(function(){e.destroy(),o.$broadcast(n.logoutSuccess)})}}]),t.service("Session",["$rootScope","AUTH_EVENTS",function(t,e){var o=this;t.$on(e.notAuthenticated,function(){o.destroy()}),t.$on(e.sessionTimeout,function(){o.destroy()}),this.user=null,this.create=function(t){this.user=t},this.destroy=function(){this.user=null}}])}());app.config(["$stateProvider",function(t){t.state("login",{url:"/login",templateUrl:"js/login/login.html",controller:"LoginCtrl"})}]),app.controller("LoginCtrl",["$scope","AuthService","$state",function(t,e,o){t.login={},t.error=null,t.sendLogin=function(n){t.error=null,e.login(n).then(function(){o.go("home")})["catch"](function(){t.error="Invalid login credentials."})}}]),app.config(["$stateProvider",function(t){t.state("membersOnly",{url:"/members-area",template:'<img ng-repeat="item in stash" width="300" ng-src="{{ item }}" />',controller:["$scope","SecretStash",function(t,e){e.getStash().then(function(e){t.stash=e})}],data:{authenticate:!0}})}]),app.factory("SecretStash",["$http",function(t){var e=function(){return t.get("/api/members/secret-stash").then(function(t){return t.data})};return{getStash:e}}]),app.factory("FullstackPics",function(){return["https://pbs.twimg.com/media/B7gBXulCAAAXQcE.jpg:large","https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-xap1/t31.0-8/10862451_10205622990359241_8027168843312841137_o.jpg","https://pbs.twimg.com/media/B-LKUshIgAEy9SK.jpg","https://pbs.twimg.com/media/B79-X7oCMAAkw7y.jpg","https://pbs.twimg.com/media/B-Uj9COIIAIFAh0.jpg:large","https://pbs.twimg.com/media/B6yIyFiCEAAql12.jpg:large","https://pbs.twimg.com/media/CE-T75lWAAAmqqJ.jpg:large","https://pbs.twimg.com/media/CEvZAg-VAAAk932.jpg:large","https://pbs.twimg.com/media/CEgNMeOXIAIfDhK.jpg:large","https://pbs.twimg.com/media/CEQyIDNWgAAu60B.jpg:large","https://pbs.twimg.com/media/CCF3T5QW8AE2lGJ.jpg:large","https://pbs.twimg.com/media/CAeVw5SWoAAALsj.jpg:large","https://pbs.twimg.com/media/CAaJIP7UkAAlIGs.jpg:large","https://pbs.twimg.com/media/CAQOw9lWEAAY9Fl.jpg:large","https://pbs.twimg.com/media/B-OQbVrCMAANwIM.jpg:large","https://pbs.twimg.com/media/B9b_erwCYAAwRcJ.png:large","https://pbs.twimg.com/media/B5PTdvnCcAEAl4x.jpg:large","https://pbs.twimg.com/media/B4qwC0iCYAAlPGh.jpg:large","https://pbs.twimg.com/media/B2b33vRIUAA9o1D.jpg:large","https://pbs.twimg.com/media/BwpIwr1IUAAvO2_.jpg:large","https://pbs.twimg.com/media/BsSseANCYAEOhLw.jpg:large","https://pbs.twimg.com/media/CJ4vLfuUwAAda4L.jpg:large","https://pbs.twimg.com/media/CI7wzjEVEAAOPpS.jpg:large","https://pbs.twimg.com/media/CIdHvT2UsAAnnHV.jpg:large","https://pbs.twimg.com/media/CGCiP_YWYAAo75V.jpg:large","https://pbs.twimg.com/media/CIS4JPIWIAI37qu.jpg:large"]}),app.factory("RandomGreetings",function(){var t=function(t){return t[Math.floor(Math.random()*t.length)]},e=["Hello, world!","At long last, I live!","Hello, simple human.","What a beautiful day!","I'm like any other project, except that I am yours. :)","This empty string is for Lindsay Levine.","こんにちは、ユーザー様。","Welcome. To. WEBSITE.",":D","Yes, I think we've met before.","Gimme 3 mins... I just grabbed this really dope frittata","If Cooper could offer only one piece of advice, it would be to nevSQUIRREL!"];return{greetings:e,getRandomGreeting:function(){return t(e)}}}),app.directive("fullstackLogo",function(){return{restrict:"E",templateUrl:"js/common/directives/fullstack-logo/fullstack-logo.html"}}),app.directive("navbar",["$rootScope","AuthService","AUTH_EVENTS","$state",function(t,e,o,n){return{restrict:"E",scope:{},templateUrl:"js/common/directives/navbar/navbar.html",link:function(i){i.items=[{label:"Home",state:"home"},{label:"About",state:"about"},{label:"Documentation",state:"docs"},{label:"Members Only",state:"membersOnly",auth:!0}],i.user=null,i.isLoggedIn=function(){return e.isAuthenticated()},i.logout=function(){e.logout().then(function(){n.go("home")})};var a=function(){e.getLoggedInUser().then(function(t){i.user=t})},r=function(){i.user=null};a(),t.$on(o.loginSuccess,a),t.$on(o.logoutSuccess,r),t.$on(o.sessionTimeout,r)}}}]),app.directive("randoGreeting",["RandomGreetings",function(t){return{restrict:"E",templateUrl:"js/common/directives/rando-greeting/rando-greeting.html",link:function(e){e.greeting=t.getRandomGreeting()}}}]);